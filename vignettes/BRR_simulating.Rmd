---
title: "Simulating from the Bayesian robust regression posterior"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{BRR_simulating}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(HMCBRR)
```

The robust regression model is given by:
\begin{align}
    y & = X\beta + \varepsilon \\
    \varepsilon_{i} & \sim \text{t}(\nu, 0, \sigma) \quad i=1,\dots,n \\
    y_{i} & \sim \text{t}(\nu, X_{i} \beta, \sigma) \quad i=1,\dots,n\\
    \beta_{j} & \sim \mathcal{N}(\mu_{j}, \sigma_{\beta_{j}}^{2}) \quad j=0,\dots,p
\end{align}
where, for simplicity, $\nu$, $\sigma$, $\mu_{j}$ and $\sigma_{\beta_{j}}^{2}$ for $j=0,\dots,p$ are known.

The posterior for Bayesian robust regression with $\mathcal{N}(\mu_{j}, C\sigma_{\beta_{j}}^{2})$ prior for $\beta_{j}$ for $j=0,\dots,p$ is given by
\begin{align}
    \pi(\beta|X,y) 
    & = \left[ \prod_{i=1}^{n} \frac{\Gamma(\frac{\nu+1}{2})}{\Gamma(\frac{\nu}{2}) \sqrt{\pi\nu} \sigma} \left( 1 + \frac{1}{\nu} \left( \frac{y_{i}-X_{i}\beta}{\sigma} \right)^{2} \right)^{-\left(\frac{\nu+1}{2}\right)} \right] \nonumber \\
    & \qquad \times \left[ \prod_{j=0}^{p} \frac{1}{\sqrt{2\pi C\sigma_{\beta_{j}}^{2}}} \exp \left( - \frac{(\beta_{j}-\mu_{j})^{2}}{2C\sigma_{\beta_{j}}^{2}} \right) \right],
\end{align}
where $y$ is the continuous dependent variable, $X$ is the design matrix so $X_{i} \beta = \beta_{0} + \beta_{1} X_{i1} + \cdots \beta_{p} X_{ip}$.


